openapi: 3.0.3
info:
  title: Translation API
  description: API for translating chapter content to Urdu
  version: 1.0.0

servers:
  - url: https://safdarayub-book-rag-api.hf.space
    description: HuggingFace Spaces Backend

paths:
  /translate:
    post:
      summary: Translate chapter content to Urdu
      description: |
        Translates the specified chapter from English to Urdu using OpenAI.
        Preserves code blocks, technical terms, and markdown formatting.
      operationId: translateChapter
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TranslateRequest'
            example:
              chapter_id: "chapter-1"
              user_id: "firebase-uid-123"
      responses:
        '200':
          description: Translation successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateResponse'
              example:
                chapter_id: "chapter-1"
                original_title: "Chapter 1: Introduction to Physical AI"
                translated_title: "باب 1: فزیکل اے آئی کا تعارف"
                translated_content: "# باب 1: فزیکل اے آئی کا تعارف\n\nاس باب میں..."
                source_language: "en"
                target_language: "ur"
                translated_at: "2025-12-24T10:30:00Z"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateError'
              example:
                error: "validation_error"
                message: "Invalid chapter_id provided"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateError'
              example:
                error: "unauthorized"
                message: "User authentication required"
        '404':
          description: Chapter not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateError'
              example:
                error: "not_found"
                message: "Chapter 'chapter-99' not found"
        '500':
          description: Translation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateError'
              example:
                error: "translation_failed"
                message: "OpenAI translation request failed"
        '504':
          description: Request timeout
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateError'
              example:
                error: "timeout"
                message: "Translation timed out after 60 seconds"

components:
  schemas:
    TranslateRequest:
      type: object
      required:
        - chapter_id
        - user_id
      properties:
        chapter_id:
          type: string
          description: Chapter identifier
          enum:
            - intro
            - chapter-1
            - chapter-2
            - chapter-3
            - chapter-4
            - chapter-5
            - chapter-6
        user_id:
          type: string
          description: Firebase UID of authenticated user

    TranslateResponse:
      type: object
      required:
        - chapter_id
        - original_title
        - translated_title
        - translated_content
        - source_language
        - target_language
        - translated_at
      properties:
        chapter_id:
          type: string
          description: Echo of requested chapter
        original_title:
          type: string
          description: Original English chapter title
        translated_title:
          type: string
          description: Urdu translated title
        translated_content:
          type: string
          description: Full Urdu translation in markdown format
        source_language:
          type: string
          enum: [en]
          description: Source language (always English)
        target_language:
          type: string
          enum: [ur]
          description: Target language (always Urdu)
        translated_at:
          type: string
          format: date-time
          description: ISO 8601 timestamp of translation

    TranslateError:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          enum:
            - validation_error
            - unauthorized
            - not_found
            - translation_failed
            - timeout
        message:
          type: string
          description: Human-readable error message
